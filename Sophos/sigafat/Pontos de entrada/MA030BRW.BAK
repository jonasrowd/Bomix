#INCLUDE "rwmake.ch"
#INCLUDE "TopConn.ch"

/*


Ŀ
Programa   MA030BRW  Autor  Diogenes Alves Cocaveli          Data  24/01/13 
Ĵ
Descrio  Executado antes da abertura do Browse de Clientes                    
Ĵ
Uso        Utilizado para realizar filtro na tela de Cadastro de Clientes       
Ĵ
Parametros 						                                                
Ĵ
Retorno                                                                         
Ĵ
 HISTORICO DE ATUALIZACOES DA ROTINA Ĵ
Ĵ
 Desenvolvedor    Data   Solic. Descricao                                     
Ĵ
 Diogenes        23/01/13       Geracao do codigo fonte                       
                                                                              
                                                                              
                                                                              
ٱ


*/

User function MA030BRW()

Local _cQry	   := ""
Local _cFiltro := ""
Local _nRecTot := 0


_cQry	+=	"SELECT Z6_CODVEND AS CODVEND, Z6_CUSERID AS IDUSR "
_cQry	+=  "FROM " + RetSqlName("SZ6") + " "
_cQry	+=	"WHERE D_E_L_E_T_ <> '*' AND Z6_CUSERID = '" + __CUSERID + "' "

TCQUERY _cQry NEW ALIAS "QRY"
DBSELECTAREA("QRY")
Count to _nRecTot
QRY->(dbGoTop())

If _nRecTot > 0
	
	While QRY->(!EOF())
		If !Empty(QRY->CODVEND)
			_cFiltro += QRY->CODVEND + "/"
		EndIf
		
		QRY->(DBSKIP())
		
	EndDo
	If !Empty(_cFiltro)
		_cFiltro := "A1_VEND $ '" + _cFiltro + "'"
	EndIf	

		DBSelectArea("QRY")
		DBCloseArea()
		
Else
		DBSELECTAREA("QRY")
		DBCloseArea()
		Return()
EndIf
	

Return(_cFiltro)
