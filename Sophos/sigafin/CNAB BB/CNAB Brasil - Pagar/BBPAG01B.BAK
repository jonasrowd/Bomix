#include "rwmake.ch"

/*
PROGRAMA  : BBPAG01B
DATA      : 04/12/09
DESCRIÇÃO : Zeca parametro sequencial do registro no lote e incrementa o total de lotes.
UTILIZAÇÃO: CNAB Brasil a Pagar - Registros Header Lote - Posições 017-017
*/

User Function BBPAG01B()

SetPrvt("CALIAS,NORD,NREG,XCONT,XPROX")
  
cAlias := Alias()
nOrd := dbSetOrder()
nReg := Recno()                   

xCont := GetMv("MV_BBPAG2")
xProx := StrZero((Val(xCont)+1),6)

dbSelectArea("SX6")
dbSeek(xFilial()+"MV_BBPAG2")
RecLock("SX6",.f.)
   Replace X6_CONTEUD With xProx
MsUnLock()

dbSelectArea("SX6")
dbSeek(xFilial()+"MV_BBPAG1")
RecLock("SX6",.f.)
   Replace X6_CONTEUD With "00000"
MsUnLock()

dbSelectArea("SX6")
dbSeek(xFilial()+"MV_BBPAG3")
RecLock("SX6",.f.)
   Replace X6_CONTEUD With Replicate("0",18)
MsUnLock()
       
dbSelectArea(cAlias)
dbSetOrder(nOrd)
dbGoTo(nReg)

return(" ")