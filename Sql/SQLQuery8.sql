SELECT DISTINCT A1.A1_OK 
 ,A1.A1_COD 
 ,A1.A1_NOME 
 ,A1.A1_LOJA 
 ,C5.C5_EMISSAO 
 ,E1.E1_EMISSAO 
 ,ISNULL(E1.E1_VENCTO,0) VENC_TIT 
 FROM SA1010 A1 
 LEFT JOIN SE1010 E1 
 ON A1.A1_FILIAL = LEFT (E1.E1_FILIAL,4) 
 AND A1.A1_COD = E1.E1_CLIENTE 
 AND A1.A1_LOJA = E1.E1_LOJA 
 AND E1.D_E_L_E_T_ <> '*' 
 AND E1.E1_VENCTO IN ( 
 SELECT MAX(E1_VENCTO) 
  FROM  SE1010 (NOLOCK) 
  WHERE E1_VENCTO >= E1_EMISSAO 
  AND E1_CLIENTE = A1_COD 
  AND E1_LOJA    = A1_LOJA 
  AND A1.A1_MSBLQL <> '1' 
  AND LEFT (E1_FILIAL,4) = A1_FILIAL 
  AND (E1.E1_BAIXA = ' ' OR E1.E1_STATUS = 'A') 
  AND D_E_L_E_T_ <>'*' ) 
  LEFT JOIN SC5010 C5 
  ON A1.A1_FILIAL = LEFT (C5.C5_FILIAL,4) 
  AND A1.A1_LOJA = C5.C5_LOJACLI 
  AND A1.A1_COD = C5.C5_CLIENTE 
  AND C5.D_E_L_E_T_ <> '*' 
  LEFT JOIN SCJ010  CJ 
  ON A1.A1_FILIAL = LEFT (CJ.CJ_FILIAL,4) 
  AND A1.A1_LOJA = CJ.CJ_LOJA 
  AND A1.A1_COD = CJ.CJ_CLIENT 
  AND C5.D_E_L_E_T_ <> '*' 
  WHERE(E1.E1_BAIXA = ' ' 
  OR E1.E1_STATUS = 'A') 
  AND C5.C5_NOTA = ' ' 
  AND A1.D_E_L_E_T_ <> '*' 
  AND CJ.CJ_STATUS IN ('C','D')
  AND A1.A1_MSBLQL <> '1' 
  AND (C5.C5_EMISSAO <= '20200731' 
  OR E1.E1_EMISSAO <= '20200731' ) 
  GROUP BY A1.A1_OK 
  ,A1.A1_COD 
  ,A1.A1_NOME 
  ,A1.A1_LOJA 
  ,C5.C5_EMISSAO 
  ,E1.E1_EMISSAO 
  ,E1.E1_VENCTO