-- Verifico se tem data de validade na B8 diferente da que está gravada na C2
SELECT * FROM SB8010 WHERE D_E_L_E_T_='' AND B8_LOTECTL IN  
(SELECT C2_FSLOTOP FROM SC2010 WHERE D_E_L_E_T_='' AND C2_FSDTVLD >= '20231012' AND B8_DTVALID<>C2_FSDTVLD AND B8_LOTECTL=C2_FSLOTOP AND C2_FILIAL='010101') 
AND B8_FILIAL='010101' 
--AND B8_LOTECTL='P689620201'
AND B8_DTVALID < '20240101'
ORDER BY B8_LOTECTL

--CORRIGE A DATA DE VALIDADE NA B8
--UPDATE SB8010 SET B8_DTVALID='20231013' WHERE B8_LOTECTL='P689360201' AND D_E_L_E_T_='' AND B8_FILIAL='010101'

--VERIFICA VISUALMENTE AS TABELAS ENVOLVIDAS 
SELECT * FROM SB8010 WHERE B8_LOTECTL='P681910102' AND D_E_L_E_T_='' ORDER BY R_E_C_N_O_ DESC
SELECT C2_FSDTVLD, C2_FSLOTOP,* FROM SC2010 WHERE D_E_L_E_T_='' AND C2_FSLOTOP='P681910102'
SELECT TOP 1000 H6_DTVALID,* FROM SH6010 WHERE D_E_L_E_T_='' 
AND H6_LOTECTL='P681910102' 
ORDER BY SH6010.H6_DTVALID ASC


